---
published: true
title:  "ë”°ë¼í•˜ë©° ë°°ìš°ëŠ” C++ Section 12. ê°€ìƒ í•¨ìˆ˜ë“¤"
excerpt: ""

categories:
  - ë”°ë°°ì”¨++
tags:
  - [C++]

toc: true
toc_sticky: true
 
date: 2022-04-28 
last_modified_at: 2022-04-30
---

# ğŸ¤” í•™ìŠµëª©í‘œ
- ë”°ë¼í•˜ë©° ë°°ìš°ëŠ” C++ Section 12. ê°€ìƒ í•¨ìˆ˜ë“¤

# ğŸ“ƒ í•™ìŠµë‚´ìš©
## ğŸ“ **ë”°ë¼í•˜ë©° ë°°ìš°ëŠ” C++ Section 12. ê°€ìƒ í•¨ìˆ˜ë“¤**

### **ğŸŒ± 12.1 ë‹¤í˜•ì„±ì˜ ê¸°ë³¸ ê°œë…**

- ìì‹ í´ë˜ìŠ¤ì˜ ê°ì²´ì— ë¶€ëª¨ í´ë˜ìŠ¤ì˜ í¬ì¸í„°ë¥¼ ì‚¬ìš©í•œë‹¤ë©´?

```cpp
#include <iostream>
#include <string>

using namespace std;

class Animal
{
protected:
	string m_name;

public:
	Animal(std::string name)
		:m_name(name)
	{}

public:
	string getName() { return m_name; }

	void speak() const
	{
		cout << m_name << " ??? " << endl;
	}
};

class Cat : public Animal
{
public:
	Cat(string name)
		: Animal(name)
	{}

	void speak() const
	{
		cout << m_name << " Meow " << endl;
	}
};

class Dog : public Animal
{
public:
	Dog(string name)
		: Animal(name)
	{}

	void speak() const
	{
		cout << m_name << " Woof " << endl;
	}
};

int main()
{
	Animal animal("My animal");
	Cat cat("My cat");
	Dog dog("My dog");

	animal.speak();
	cat.speak();
	dog.speak();

	Animal* ptr_animal1 = &cat;
	Animal* ptr_animal2 = &dog;

	ptr_animal1->speak();
	ptr_animal2->speak();

	//My animal ? ? ?
	//My cat Meow
	//My dog Woof
	//My cat ? ? ?
	//My dog ? ? ?


	return 0;
}
```

- ìì‹í´ë˜ìŠ¤ë¥¼ ë¶€ëª¨í´ë˜ìŠ¤ì˜ í¬ì¸í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ìºìŠ¤íŒ…í•˜ì—¬ í˜¸ì¶œí•˜ë©´ ìì‹ ì´ ë¶€ëª¨í´ë˜ìŠ¤ë¡œ ì¸ì‹í•˜ì—¬ í˜¸ì¶œí•¨

___


```cpp
#include <iostream>
#include <string>

using namespace std;

class Animal
{
protected:
	string m_name;

public:
	Animal(std::string name)
		:m_name(name)
	{}

public:
	string getName() { return m_name; }

	void speak() const
	{
		cout << m_name << " ??? " << endl;
	}
};

class Cat : public Animal
{
public:
	Cat(string name)
		: Animal(name)
	{}

	void speak() const
	{
		cout << m_name << " Meow " << endl;
	}
};

class Dog : public Animal
{
public:
	Dog(string name)
		: Animal(name)
	{}

	void speak() const
	{
		cout << m_name << " Woof " << endl;
	}
};

int main()
{
	Cat cats[] = { Cat("cat1"), Cat("cat2"), Cat("cat3"), Cat("cat4"), Cat("cat5") };
	Dog dogs[] = { Dog("dog1"),Dog("dog2") };

  Animal* my_animals[] = { &cats [0],&cats[1] ,&cats[2] ,&cats[3] ,&cats[4],
	&dogs[0],& dogs[1] };

	for (int i = 0; i < 7; ++i)
		my_animals[i]->speak();

    // cat1 ???
    // cat2 ???
    // cat3 ???
    // cat4 ???
    // cat5 ???
    // dog1 ???
    // dog2 ???

	return 0;
}
```

- ìƒì†ë°›ì€ ë¶€ëª¨í´ë˜ìŠ¤ê°€ ê°™ê¸° ë•Œë¬¸ì— `my_animals[]` ì•ˆì— catsì™€ dogs ë¥¼ ê°™ì´ë„£ì„ìˆ˜ ìˆìŒ

**virtual**

```cpp
#include <iostream>
#include <string>

using namespace std;

class Animal
{
protected:
	string m_name;

public:
	Animal(std::string name)
		:m_name(name)
	{}

public:
	string getName() { return m_name; }

	virtual void speak() const
	{
		cout << m_name << " ??? " << endl;
	}
};

class Cat : public Animal
{
public:
	Cat(string name)
		: Animal(name)
	{}

	void speak() const
	{
		cout << m_name << " Meow " << endl;
	}
};

class Dog : public Animal
{
public:
	Dog(string name)
		: Animal(name)
	{}

	void speak() const
	{
		cout << m_name << " Woof " << endl;
	}
};

int main()
{
	Cat cats[] = { Cat("cat1"), Cat("cat2"), Cat("cat3"), Cat("cat4"), Cat("cat5") };
	Dog dogs[] = { Dog("dog1"),Dog("dog2") };

	Animal* my_animals[] = { &cats [0],&cats[1] ,&cats[2] ,&cats[3] ,&cats[4],
	&dogs[0],& dogs[1] };

	for (int i = 0; i < 7; ++i)
		my_animals[i]->speak();

    // cat1 Meow
    // cat2 Meow
    // cat3 Meow
    // cat4 Meow
    // cat5 Meow
    // dog1 Woof
    // dog2 Woof

	return 0;
}
```

- `virtual void speak() const` ë¶€ëª¨í´ë˜ìŠ¤ì— ë©¤ë²„í•¨ìˆ˜ ì•ì— `virtual` í‚¤ì›Œë“œë¥¼ ë¶™ì—¬ì£¼ë©´ ìì‹í´ë˜ìŠ¤ì¸ê²ƒ ì²˜ëŸ¼ ë™ì‘í•¨

### **ğŸŒ± 12.2 ê°€ìƒ í•¨ìˆ˜ì™€ ë‹¤í˜•ì„±**

- ê°€ìƒ í•¨ìˆ˜ Virtual Functions 
- ë‹¤í˜•ì„± Polymorphism

```cpp
#include <iostream>

using namespace std;

class A
{
public:
	void print() { cout << "A" << endl; }
};

class B : public A
{
public:
	void print() { cout << "B" << endl; }
};

class C : public B
{
public:
	void print() { cout << "C" << endl; }
};

class D : public C
{
public:
	void print() { cout << "D" << endl; }
};
int main()
{
	A a;
	B b;
	C c;
	D d;

	A& ref = b;
	ref.print(); // A

	return 0;
}
```

- ë ˆí¼ëŸ°ìŠ¤ë¥¼ Aì— ë’€ë‹¤ëŠ” ì´ìœ ë¡œ Aë¡œ ì¶œë ¥ë¨
- í¬ì¸í„°ë¡œ í•´ë„ ë™ì¼í•¨

**virtual**

```cpp
#include <iostream>

using namespace std;

class A
{
public:
	virtual void print() { cout << "A" << endl; }
};

class B : public A
{
public:
	void print() { cout << "B" << endl; }
};

class C : public B
{
public:
	void print() { cout << "C" << endl; }
};

class D : public C
{
public:
	void print() { cout << "D" << endl; }
};
int main()
{
	A a;
	B b;
	C c;
	D d;

	A& ref = b;
	ref.print(); // B

	return 0;
}
```

- Bí´ë˜ìŠ¤ë¡œ ë§Œë“¤ì–´ì§„ ì¸ìŠ¤í„´ìŠ¤ë¥¼ Aë¡œ ë„£ì—ˆëŠ”ë° Aì•ˆì—ìˆëŠ” print()ê°€ virtual ì¼ê²½ìš° Bí´ë˜ìŠ¤ì˜ print() ê°€ ì‹¤í–‰ì´ë¨
- ë ˆí¼ëŸ°ìŠ¤ì— cë¥¼ ë„£ì–´ë„ Cê°€ ì¶œë ¥ë¨ Aì˜ ë ˆí¼ëŸ°ìŠ¤ë¥¼ í†µí•´ì„œ print()ë¥¼ í˜¸ì¶œí–ˆì„ë•Œ Bë¥¼ ì‚¬ìš©í•˜ëŠ”ê²ƒì´ì•„ë‹Œ Cë¥¼ ì‚¬ìš©í•¨
- ì‹¤ë¬´ì—ì„œ ê¸°ì–µì•ˆë‚ ë• ê°„ë‹¨í•œ ì˜ˆì œë¥¼ ë§Œë“¤ê³  ì‹¤í–‰ì‹œì¼œì„œ í…ŒìŠ¤íŠ¸í•´ë³´ê³  ë¬¸ë²• ë˜ìƒˆê¹€í•˜ê¸°

```cpp
#include <iostream>

using namespace std;

class A
{
public:
	virtual void print() { cout << "A" << endl; }
};

// class B
class B : public A
{
public:
	void print() { cout << "B" << endl; }
};

class C : public B
{
public:
	void print() { cout << "C" << endl; }
};

class D : public C
{
public:
	void print() { cout << "D" << endl; }
};
int main()
{
	A a;
	B b;
	C c;
	D d;

	B& ref = c;
	ref.print(); // C

	return 0;
}
```

- ìƒì†ë‹¨ê³„ë¥¼ ëŠì—ˆì„ë•ŒëŠ” Bê°€ ì¶œë ¥ì´ë¨
- ê°€ì¥ ìƒìœ„í´ë˜ìŠ¤ì— ìˆëŠ”ê²Œ virtualì´ ë˜ë©´ í•˜ìœ„ í´ë˜ìŠ¤ë“¤ë„ virtualì´ ì ìš©ì´ë¨
  - ê´€ìŠµì ìœ¼ë¡œ í•˜ìœ„ í´ë˜ìŠ¤ì—ë„ virtual ì„ ì ì–´ì¤Œ

**ì˜¤ë²„ë¼ì´ë”©ì‹œ ë¦¬í„´íƒ€ì…ì´ ë‹¤ë¥¼ê²½ìš° ì—ëŸ¬ê°€ ë°œìƒí•¨**

```cpp
#include <iostream>

using namespace std;

class A
{
public:
	virtual void print() { cout << "A" << endl; }
};

class B : public A
{
public:
	virtual void print() { cout << "B" << endl; }
};

class C : public B
{
public:
	virtual void print() { cout << "C" << endl; }
};

class D : public C
{
public:
	virtual int print() { cout << "D" << endl;  return 0; } // Error
};

int main()
{
	A a;
	B b;
	C c;
	D d;

	B& ref = c;
	ref.print(); // C

	return 0;
}
```

- ë§ìœ¼ë©´ 3ë‹¨ê³„ ë³´í†µ 2ë‹¨ê³„ virtual í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•¨
- virtual í…Œì´ë¸”ì—ì„œ í•¨ìˆ˜ë¥¼ ì°¾ì•„ê°€ëŠ” ê³¼ì •ì„ ê±°ì¹¨
  - í˜¸ì¶œì´ ë¹ˆë²ˆí•œ í•¨ìˆ˜ì— ì‚¬ìš©í•˜ë©´ í¼í¬ë¨¼ìŠ¤ê°€ ì•ˆì¢‹ìŒ
  - for roop ì•ˆì— ë„£ìœ¼ë©´ í˜„ì €íˆ ëŠë ¤ì§

### **ğŸŒ± 12.3 override, final, ê³µë³€ ë°˜í™˜ê°’**

- ê³µë³€ ë°˜í™˜ ê°’ Covariant

```cpp
#include <iostream>

using namespace std;

class A
{
public:
	virtual void print(int x) { cout << "A" << endl; }
};

class B : public A
{
public:
	virtual void print(short x) { cout << "B" << endl; }
};


int main()
{
	A a;
	B b;

	A& ref = b;
	ref.print(1); // A

	return 0;
}
```

- Aê°€ ì¶œë ¥ë˜ëŠ” ì´ìœ 
- í•¨ìˆ˜ëŠ” íŒŒë¼ë©”íƒ€ê°€ ë‹¤ë¥´ë©´ ì˜¤ë²„ë¼ì´ë”©ì„ í• ìˆ˜ê°€ ì—†ìŒ

___

**override**

```cpp
#include <iostream>

using namespace std;

class A
{
public:
	virtual void print(int x) { cout << "A" << endl; }
};

class B : public A
{
public:
	virtual void print(short x) override { cout << "B" << endl; } // Error
};


int main()
{
	A a;
	B b;

	A& ref = b;
	ref.print(1); // A

	return 0;
}
```
- ì˜ˆë¹„ì¡°ì¹˜ë¡œ overrideë¥¼ ì¹˜ë©´ë¨
  - ë¯¸ë¦¬ ì—ëŸ¬ë¥¼ ì¡ì„ìˆ˜ ìˆìŒ
- ìì‹í´ë˜ìŠ¤ì—ì„œ ì–´ë–¤í•¨ìˆ˜ë¥¼ êµ¬í˜„í• ë•Œ ìƒìœ„í´ë˜ìŠ¤ì— virtual í•¨ìˆ˜ë¥¼ ì˜¤ë²„ë¼ì´ë“œí•˜ê³ ì‹¶ì€ê±°ë¼ë©´ overrideë¥¼ ì ì–´ ì´í•¨ìˆ˜ëŠ” ë¬´ì¡°ê±´ ì˜¤ë²„ë¼ì´ë“œ í•´ì•¼í•œë‹¤ê³  ì»´íŒŒì¼ëŸ¬ì—ê²Œ ë¯¸ë¦¬ ì•Œë ¤ì£¼ëŠ”ê²ƒ
- const, í•¨ìˆ˜ì´ë¦„ ë“±ì„ ë‹¤ë¥´ê²Œí–ˆì„ë•Œ ì°¾ì„ìˆ˜ ìˆìŒ

___

**final**

```cpp
#include <iostream>

using namespace std;

class A
{
public:
	virtual void print() { cout << "A" << endl; }
};

class B : public A
{
public:
	virtual void print() final { cout << "B" << endl; }
};

class C : public B
{
public:
	virtual void print() final { cout << "C" << endl; } // Error
};


int main()
{
	A a;
	B b;

	A& ref = b;
	ref.print(); 

	return 0;
}
```

- ë°‘ì—ì„œ overrideë¥¼ ëª»í•˜ê²Œ ë§‰ì•„ë²„ë¦¬ê³ ì‹¶ì„ë•Œ ì‚¬ìš©í•˜ëŠ” í‚¤ì›Œë“œ

```cpp
#include <iostream>

using namespace std;

class A
{
public:
	void print() { cout << "A" << endl; }
	virtual A* getThis() { 
		cout << "B::getThis()" << endl; 
		return this; }
};

class B : public A
{
public:
	void print() { cout << "B" << endl; }
	virtual B* getThis() { 
		cout << "B::getThis()" << endl;
		return this; }
};

int main()
{
	A a;
	B b;

	A& ref = b;
	b.getThis()->print();
	ref.getThis()->print();

	cout << typeid(b.getThis()).name() << endl;
	cout << typeid(ref.getThis()).name() << endl;

  // B::getThis()
  // B
  // B::getThis()
  // A
  // class B * __ptr64
  // class A * __ptr64

	return 0;
}
```

- ë ˆí¼ëŸ°ìŠ¤ ê°€ Aì´ê¸° ë•Œë¬¸ì— Bì˜ í¬ì¸í„°ë¥¼ ë¦¬í„´í•´ì¤˜ë„ ë‚´ë¶€ì ìœ¼ë¡œ Aí¬ì¸í„°ë¡œ ë³€í™˜í•œ ë‹¤ìŒì— í˜¸ì¶œí•˜ëŠ” êµ¬ì¡°ì„

### **ğŸŒ± 12.4 ê°€ìƒ ì†Œë©¸ì**

```cpp
#include <iostream>

using namespace std;

class Base
{
public:
	~Base()
	{
		cout << "~Base()" << endl;
	}
};

class Dericed :public Base
{
private:
	int* m_array;

public:
	Dericed(int length)
	{
		m_array = new int[length];
	}

	~Dericed()
	{
		cout << "~Dericed()" << endl;
		delete[] m_array;
	}
};

int main()
{
	Dericed dericed(5);

	//~Dericed()
	//~Base()

	return 0;
}
```

- ì†Œë©¸ì í˜¸ì¶œìˆœì„œëŠ” ìƒì„±ì í˜¸ì¶œìˆœì„œì˜ ë°˜ëŒ€ì„

**ë‹¤í˜•ì„± êµ¬ì¡°**

```cpp
#include <iostream>

using namespace std;

class Base
{
public:
	~Base()
	{
		cout << "~Base()" << endl;
	}
};

class Dericed :public Base
{
private:
	int* m_array;

public:
	Dericed(int length)
	{
		m_array = new int[length];
	}

	~Dericed()
	{
		cout << "~Dericed()" << endl;
		delete[] m_array;
	}
};

int main()
{
	Dericed* dericed = new Dericed(5);
	Base* base = dericed;
	delete base;

  // ~Base()

	return 0;
}
```

- baseì˜ ì†Œë©¸ìë§Œ ìƒì„±ì´ë¨
  - ë©”ëª¨ë¦¬ ë¦­ì´ ìƒê¹€
  - ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš©í•˜ë©´ ìë™ìœ¼ë¡œ í•´ê²°ë¨

___

**ì†Œë©¸ìì— virtualí‚¤ì›Œë“œ**

```cpp
#include <iostream>

using namespace std;

class Base
{
public:
	virtual ~Base()
	{
		cout << "~Base()" << endl;
	}
};

class Dericed :public Base
{
private:
	int* m_array;

public:
	Dericed(int length)
	{
		m_array = new int[length];
	}

	virtual ~Dericed() override
	{
		cout << "~Dericed()" << endl;
		delete[] m_array;
	}
};

int main()
{

	Dericed* dericed = new Dericed(5);
	Base* base = dericed;
	delete base;

  // ~Dericed()
  // ~Base()

	return 0;
}
```

- virtualì„ ë–¼ë©´ `override` ë¥¼ ì ì—ˆì„ë•Œ ì—ëŸ¬ê°€ ë°œìƒí•¨

### **ğŸŒ± 12.5 ë™ì  ë°”ì¸ë”©ê³¼ ì •ì  ë°”ì¸ë”©**

- Binding

**ì •ì  ë°”ì¸ë”© Static Binding**

```cpp
#include <iostream>

using namespace std;

int add(int x, int y)
{
    return x + y;
}

int subtract(int x, int y)
{
    return x - y;
}


int main()
{
    int x, y;
    cin >> x >> y;

    int op;

    cout << "0: add, 1: subtract" << endl;
    cin >> op;

	// static binding(early binding) 
    int result;
    switch (op)
    {
    case 0: result = add(x, y); break;
    case 1: result = subtract(x, y); break;
    }
}
```

- ëª¨ë“  ë³€ìˆ˜ëª…ì´ë‚˜ í•¨ìˆ˜ëª…ì´ ë¹Œë“œíƒ€ì„ì— ì •ë¦¬ë˜ì–´ ìˆëŠ”ê²ƒì„ static binding(early binding) ì´ë¼ê³ í•¨

**ë™ì  ë°”ì¸ë”© Dynamic Binding**

```cpp
#include <iostream>

using namespace std;

int add(int x, int y)
{
    return x + y;
}

int subtract(int x, int y)
{
    return x - y;
}


int main()
{
    int x, y;
    cin >> x >> y;

    int op;

    cout << "0: add, 1: subtract" << endl;
    cin >> op;

    int(*func_ptr)(int, int) = nullptr;
    switch (op)
    {
    case 0: func_ptr = add; break;
    case 1: func_ptr = subtract; break;
    }

	cout << func_ptr(x, y) << endl;
}
```

- func_ptrì˜ ì£¼ì†Œê°€ ëŸ°íƒ€ì„ì— ê²°ì •ë¨
- í‘ì…˜í¬ì¸í„°ì— ì €ì¥ë˜ì–´ ìˆëŠ” ì£¼ì†Œë¥¼ ì°¾ì•„ê°€ì„œ ì£¼ì†Œìë¦¬ì— ìˆëŠ” í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚´

___

- ì†ë„: ì •ì  ë°”ì¸ë”© > ë™ì  ë°”ì¸ë”© 

- ëŒ€ì‹  ë™ì  ë°”ì¸ë”©ì„ ì‚¬ìš©í•˜ë©´ í”„ë¡œê·¸ë¨ì´ ì¡°ê¸ˆ ë” ìœ ì—°í•´ì§

### **ğŸŒ± 12.6 ê°€ìƒ (í•¨ìˆ˜) í‘œ**

- Virtual Tables
- virtual ì´ ì„ ì–¸ë˜ë©´ virtualì˜ í‘œë¥¼ë§Œë“¤ê³  ë™ì ë°”ì¸ë”©ì„ í•¨

**ë¶€ëª¨ class virtual í•¨ìˆ˜ ì„ ì–¸ ìˆœì„œ**
  1. virtual í•¨ìˆ˜ê°€ ì„ ì–¸ë˜ë©´ virtualì˜ í‘œì— ê°€ì„œ í•´ë‹¹ í•¨ìˆ˜ì˜ í¬ì¸í„°ë¥¼ ì°¾ìŒ
  2. í•´ë‹¹ í•¨ìˆ˜ì˜ í¬ì¸í„°ê°€ ê°€ë¥´í‚¤ëŠ” ì£¼ì†Œì—ê°
  3. ê·¸ ì£¼ì†Œì— ìˆëŠ” í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚´

**ìì‹ class virtual í•¨ìˆ˜ ì„ ì–¸ ìˆœì„œ**
  1. virtual í•¨ìˆ˜ê°€ ì„ ì–¸ë˜ë©´ virtualì˜ í‘œì— ê°€ì„œ í•´ë‹¹ í•¨ìˆ˜ì˜ í¬ì¸í„°ë¥¼ ì°¾ìŒ
  2. ì˜¤ë²„ë¼ì´ë”©ì´ ë˜ì–´ìˆëŠ” í•¨ìˆ˜ë©´ ìì‹í´ë˜ìŠ¤ì˜ í•¨ìˆ˜ë¡œ ê°€ì„œ ì‹¤í–‰ì‹œí‚´
  3. ì˜¤ë²„ë¼ì´ë”©ì´ ë˜ì–´ìˆì§€ ì•Šì€ í•¨ìˆ˜ë©´ ë¶€ëª¨í´ë˜ìŠ¤ë¡œ ê°€ì„œ ì‹¤í–‰ì‹œí‚´

- ìì‹í´ë˜ìŠ¤ë¡œ ìƒì„±ì´ ëœê°ì²´ë¡œ í˜¸ì¶œí•´ë„ Virtual Tables ì´ ë°”ë€Œì§€ ì•Šê¸°ë•Œë¬¸ì— ë‹¤í˜•ì„±ì„ ì‚¬ìš©í• ìˆ˜ ìˆëŠ”ê²ƒ

___

```cpp
#include <iostream>

using namespace std;

class Base
{
public:
    void fun1() {};
    void fun2() {};
};

class Derived : public Base
{

};

int main()
{
    cout<< sizeof(Base) << endl; // 1
    cout<< sizeof(Derived) << endl; // 1

    return 0;
}
```

**virtual**

```cpp
#include <iostream>

using namespace std;

class Base
{
public:
    virtual void fun1() {};
    void fun2() {};
};

class Derived : public Base
{

};

int main()
{
    cout << sizeof(Base) << endl; // 8
    cout << sizeof(Derived) << endl; // 8

    return 0;
}
```

- ë¶€ëª¨í´ë˜ìŠ¤ëŠ” ê°€ìƒ í•¨ìˆ˜ë¥¼ ê°€ì§, ê°€ìƒ í•¨ìˆ˜ í¬ì¸í„°ë¥¼ ê°–ê³  ìˆìŒ
- ê°€ìƒ í•¨ìˆ˜ í¬ì¸í„° ë•Œë¬¸ì— ê°€ìƒ í•¨ìˆ˜ë¥¼ ê°€ì§€ì§€ ì•Šì•˜ì„ ë•Œë³´ë‹¤ í¬ê¸°ê°€ ë” ì»¤ì§
- ìì‹í´ë˜ìŠ¤ëŠ” ë¶€ëª¨í´ë˜ìŠ¤ë¡œë¶€í„° ê°€ìƒ í•¨ìˆ˜ í¬ì¸í„°ë¥¼ ìƒì†ë°›ê¸° ë•Œë¬¸ì— ì–˜ë„ ë˜‘ê°™ì´ í¬ê¸°ê°€ ë” ì»¤ì§

### **ğŸŒ± 12.7 ìˆœìˆ˜ ê°€ìƒ í•¨ìˆ˜, ì¶”ìƒ ê¸°ë³¸ í´ë˜ìŠ¤, ì¸í„°í˜ì´ìŠ¤ í´ë˜ìŠ¤**

- Pure
- Absteact
- Interface

- **ì¶”ìƒ ê¸°ë³¸ í´ë˜ìŠ¤:** ìˆœìˆ˜ ê°€ìƒ í•¨ìˆ˜ê°€ í¬í•¨ëœ í´ë˜ìŠ¤
- **ì¸í„°í˜ì´ìŠ¤ í´ë˜ìŠ¤:** ìˆœìˆ˜ ê°€ìƒ í•¨ìˆ˜ë¡œë§Œ ì´ë£¨ì–´ì§„ í´ë˜ìŠ¤

___


**ìˆœìˆ˜ ê°€ìƒ í•¨ìˆ˜**

```cpp
#include <iostream>

using namespace std;

class Animal
{
protected:
    string m_name;
public:
    Animal(std::string name)
        :m_name(name)
    {}
public:
    string getName() { return m_name; }
    virtual void speak() const = 0;  // pure virtual Function
};


class Cow : public Animal
{
protected:
    string m_name;
public:
    Cow(std::string name)
        :Animal(name)
    {}
};


void Animal::speak() const // the bodu of the pure virtual Function
{
    cout << m_name << endl;
}


int main()
{
    Cow cow("hello");  // Error ìì‹í´ë˜ìŠ¤ì—ì„œ ì˜¤ë²„ë¼ì´ë“œê°€ ì•ˆë˜ì–´ìˆì–´ì„œ ëª»ë§Œë“¬
    Animal ani("Hi");  // Error ì¶”ìƒí´ë˜ìŠ¤ë¡œ ê°ì²´ë¥¼ ëª»ë§Œë“¬
}
```

- ìˆœìˆ˜ ê°€ìƒ í•¨ìˆ˜ë„ ë°”ë””ë¡œë§Œ ì •ì˜ í•  ìˆ˜ë„ ìˆìŒ
	- ì˜ë¯¸ ì—†ìŒ êµ¬í˜„ì„í•´ë„ í˜¸ì¶œì„ í• ìˆ˜ê°€ ì—†ìŒ
- ìˆœìˆ˜ ê°€ìƒ í•¨ìˆ˜ëŠ” ë¶€ëª¨í´ë˜ìŠ¤ì—ì„  ì–´ë–»ê²Œ í• ì§€ ëª¨ë¥´ê³  ìì‹í´ë˜ìŠ¤ì—ì„œ ë¬´ì¡°ê±´ êµ¬í˜„í•˜ë¼ëŠ” ëœ»ì„
- í´ë˜ìŠ¤ë¥¼ ì„¤ê³„í• ë•Œ ìƒì†êµ¬ì¡°ë¥¼ í•œêº¼ë²ˆì— ì„¤ê³„í•˜ë„ë¡ ë„ì™€ì£¼ëŠ” ë¬¸ë²•ì´ë¼ê³  ìƒê°í•˜ë©´ë¨

___

**ì¸í„°í˜ì´ìŠ¤ í´ë˜ìŠ¤**

```cpp
class IErrorLog
{
public:
    virtual bool reportError(const char * error) = 0;
    virtual ~IErrorLog() {}
};


class FileErrorLog : public IErrorLog
{
public:
    bool reportError(const char * errorMessage) override
    {
        cout << "Writing error to a file" << endl;
        return true;
    }
};


class ConsoleErrorLog : public IErrorLog
{
public:
    bool reportError(const char * errorMessage) override
    {
        cout << "Printing error to a console" << endl;
        return true;
    }
};


void doSomething(IErrorLog & log)
{
    log.reportError("Runtime error!!");
}


int main()
{
    FileErrorLog file_log;
    ConsoleErrorLog console_log;

    doSomething(file_log); 		// Writing error to a file
    doSomething(console_log); 	// Printing error to a console
}
```

- ë‚´ë¶€í•¨ìˆ˜ê°€ ëª¨ë‘ ìˆœìˆ˜ ê°€ìƒí•¨ìˆ˜ ì¼ë•Œ ì¸í„°í˜ì´ìŠ¤ í´ë˜ìŠ¤ë¼ê³  í•¨
- ì™¸ë¶€ì—ì„œ ì‚¬ìš©í• ë•Œ ì´ëŸ¬ì´ëŸ¬í•œ ê¸°ëŠ¥ì´ ìˆë‹¤ê³  ì•Œë ¤ì£¼ê¸°ë•Œë¬¸ì— ì¸í„°í˜ì´ìŠ¤ í´ë˜ìŠ¤ë¼ê³ í•¨
- ì¸í„°í˜ì´ìŠ¤ ì¼ê²½ìš° `I`ë¥¼ë¶™ì—¬ì£¼ëŠ”ê²Œ ê´€ìŠµì„

### **ğŸŒ± 12.8 ê°€ìƒ ê¸°ë³¸ í´ë˜ìŠ¤ì™€ ë‹¤ì´ì•„ëª¬ë“œ ìƒì† ë¬¸ì œ**

- Virtyal vase classes
- The diamond problem

- ê°™ì€ ë¶€ëª¨í´ë˜ìŠ¤ë¡œ ìƒì†ë°›ëŠ” ë‘ê°œì˜ ìì‹ í´ë˜ìŠ¤ê°€ ìˆì„ë•Œ ë¶€ëª¨í´ë˜ìŠ¤ê°€ ë‘ê°œë¡œ ë‚˜ë‰˜ì–´ ì§€ëŠ” ë¬¸ì œê°€ ë°œìƒí•¨
  - ì´ë¥¼ ë°©ì§€í•˜ê¸°ìœ„í•´ ìƒì† ë°›ì„ë•Œ virtual ì„ ë„£ì–´ì„œ ê°€ìƒ ê¸°ë³¸ í´ë˜ìŠ¤ë¥¼ ë§Œë“¬

```cpp
#include <iostream>

using namespace std;

class PoweredDevice
{
public:
	int m_i;

	PoweredDevice(int power)
	{
		cout << "PoweredDevice: " << power << "\n";
	}
};

class Scanner : public PoweredDevice
{
public:
	Scanner(int scanner, int power)
		:PoweredDevice(power)
	{
		cout << "Scanner: " << scanner << "\n";
	}
};

class Printer : public PoweredDevice
{
public:
	Printer(int printer, int power)
		: PoweredDevice(power)
	{
		cout << "Printer: " << printer << "\n";
	}
};

class Copier : public Scanner, public Printer
{
public:
	Copier(int scanner, int printer, int power)
		: Scanner(scanner, power), Printer(printer, power)
	{}

};

int main()
{
	Copier cop(1, 2, 3); //ìƒì„±ì í˜¸ì¶œ

    cout << &cop.Scanner::PoweredDevice::m_i << endl;
	cout << &cop.Printer::PoweredDevice::m_i << endl;

	// ì¶œë ¥ ê²°ê³¼
	// PoweredDevice: 3
	// Scanner: 1
	// PoweredDevice: 3
	// Printer: 2
	// 000000DF2518F9F8
	// 000000DF2518F9FC

	return 0;
}
```

- ìƒì„±ìë„ ë‘ë²ˆ í˜¸ì¶œë˜ê³  ì£¼ì†Œë„ ë‹¤ë¦„

**ê°€ìƒ ê¸°ë³¸ í´ë˜ìŠ¤**

```cpp
#include <iostream>

using namespace std;

class PoweredDevice
{
public:
	int m_i;

	PoweredDevice(int power)
	{
		cout << "PoweredDevice: " << power << "\n";
	}
};

class Scanner : virtual public PoweredDevice
{
public:
	Scanner(int scanner, int power)
		:PoweredDevice(power)
	{
		cout << "Scanner: " << scanner << "\n";
	}
};

class Printer : virtual public PoweredDevice
{
public:
	Printer(int printer, int power)
		: PoweredDevice(power)
	{
		cout << "Printer: " << printer << "\n";
	}
};

class Copier : public Scanner, public Printer
{
public:
	Copier(int scanner, int printer, int power)
		: Scanner(scanner, power), Printer(printer, power),
		PoweredDevice(power)
	{}

};

int main()
{
	Copier cop(1, 2, 3); //ìƒì„±ì í˜¸ì¶œ

	cout << &cop.Scanner::PoweredDevice::m_i << endl;
	cout << &cop.Printer::PoweredDevice::m_i << endl;

	// ì¶œë ¥ ê²°ê³¼
	// PoweredDevice: 3
	// Scanner: 1
	// Printer: 2
	// 00000016BD2FFBB8
	// 00000016BD2FFBB8

	return 0;
}
```

- ìì‹í´ë˜ìŠ¤ì— virtualë¥¼ ë„£ì–´ì£¼ê³  `PoweredDevice(power)` ìƒì„±ìë¥¼ ë„£ì–´ì¤Œ
- ìƒì„±ì í˜¸ì¶œ í•œë²ˆë˜ê³  ë³€ìˆ˜ì˜ ë©”ëª¨ë¦¬ ì£¼ì†Œê°€ ê°™ìŒ

### **ğŸŒ± 12.9 ê°ì²´ ì˜ë¦¼ê³¼ reference wrapper**

- Object slicing
- reference_wrapper

```cpp
#include <iostream>
#include <vector>
#include <functional> 

using namespace std;

class Base
{
public:
	int m_i = 0;

	virtual void print()
	{
		cout << "I'm Base" << endl;
	}
};

class Derived : public Base
{
public:
	int m_j = 1;

	virtual void print() override
	{
		cout << "I'm derived" << endl;
	}
};

int main()
{
	Derived d;
	Base& b1 = d;

	b1.print();

	return 0;
}
```

**ê°ì²´ ì˜ë¦¼**

```cpp
int main()
{
	Derived d;
	Base b = d;

	b.print();  

	return 0;
}
```

- &ë¥¼ ë¹¼ê²Œ ë˜ë©´ ë³µì‚¬ ëŒ€ì…ì´ ë¨
	- Baseì—ì„  Derived ì˜ ì •ë³´ë¥¼ ë‹¤ ë‹´ì„ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— Derivedì˜ ì •ë³´ê°€ ì˜ë ¤ì„œ ì €ì¥ì´ë¨
  	- ë‹¤í˜•ì„±ë„ ì‚¬ë¼ì§€ê²Œë¨
- ì˜ë„ì ìœ¼ë¡œ ìŠ¬ë¼ì´ì‹±ì„ ì‚¬ìš©í• ë•Œ ì£¼ì„ìœ¼ë¡œ ë‚¨ê²¨ë‘ê¸°
- í•¨ìˆ˜ì˜ íŒŒë¼ë©”í„° ë™ì¼í•˜ê²Œ ë°œìƒí• ìˆ˜ ìˆìŒ

___

**ìŠ¬ë¼ì´ìŠ¤ ë¬¸ì œ**

```cpp
#include <iostream>
#include <vector>
#include <functional> // reference_wrapper ìš©

using namespace std;

class Base
{
public:
	int m_i = 0;

	virtual void print()
	{
		cout << "I'm Base" << endl;
	}
};

class Derived : public Base
{
public:
	int m_j = 1;

	virtual void print() override
	{
		cout << "I'm derived" << endl;
	}
};

int main()
{
	Base b;
	Derived d;

	std::vector<Base> my_vec;
	my_vec.push_back(b);
	my_vec.push_back(d);

	for (auto& ele : my_vec)
		ele.print();

	/*I'm Base
	I'm Base*/

	return 0;
}
```

- ë‘ë²ˆì§¸ ê²ƒì€ Derivedì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë„£ì—ˆì§€ë§Œ ìŠ¬ë¼ì´ìŠ¤ê°€ ë°œìƒë˜ì–´ I'm Base ê°€ ì¶œë ¥ì´ë¨
- vectorì—ëŠ” ë ˆí¼ëŸ°ìŠ¤ë¥¼ ë„£ì„ìˆ˜ ì—†ìŒ

**í¬ì¸í„°ë¡œ í•´ê²°í•˜ê¸°**

```cpp
int main()
{
	Base b;
	Derived d;

	std::vector<Base*> my_vec;
	my_vec.push_back(&b);
	my_vec.push_back(&d);

	for (auto& ele : my_vec)
		ele->print();

	return 0;
}
```

**ë ˆí¼ëŸ°ìŠ¤ë¡œ í•´ê²°í•˜ê¸°**

```cpp
int main()
{
	Base b;
	Derived d;

	std::vector<std::reference_wrapper<Base>> my_vec;
	my_vec.push_back(b);
	my_vec.push_back(d);

	for (auto& ele : my_vec)
		ele.get().print();

	return 0;
}
```

- my_vec ëŠ” Baseì˜ ë ˆí¼ëŸ°ìŠ¤ë¥¼ ì €ì¥í•˜ëŠ” ë°±í„°ê°€ ë¨
- `std::vector<Base&> my_vec;` ì²˜ëŸ¼ ì‘ë™í•¨
  - ìœ„ ì½”ë“œëŠ” ë¬¸ë²•ì ìœ¼ë¡œ ì§€ì›ì„ ì•ˆí•¨

### **ğŸŒ± 12.10 ë™ì  í˜•ë³€í™˜**

- Dynamic Casting
- ìì‹í´ë˜ìŠ¤ì˜ í¬ì¸í„°ë¥¼ ë¶€ëª¨í´ë˜ìŠ¤ì˜ í¬ì¸í„°ë¡œ ë°”ê¾¸ê³  ë‹¤ì‹œ ìì‹í´ë˜ìŠ¤ë¡œ ë°”ê¿”ì•¼í•˜ëŠ” ìƒí™©ì—ì„œ ì‚¬ìš©í•¨

```cpp
#include <iostream>
#include <string>

using namespace std;

class Base
{
public:
	int m_i = 0;

	virtual void print()
	{
		cout << "I'm Base" << endl;
	}
};

class Derived1 : public Base
{
public:
	int m_j = 1024;

	virtual void print() override
	{
		cout << "I'm derived_1" << endl;
	}
};

class Derived2 : public Base
{
public:
	string m_name = "Dr. Two";

	virtual void print() override
	{
		cout << "I'm derived_2" << endl;
	}
};

int main()
{
	Derived1 d1;
	Base* base = &d1;
	d1.m_j = 2048;

	auto* base_to_d1 = dynamic_cast<Derived1*>(base);
	cout << base_to_d1->m_j << endl;
	base_to_d1->m_j = 256;

	cout << d1.m_j << endl;
	return 0;
}
```

- `dynamic_cast` baseë¥¼ Derived1ìœ¼ë¡œ ë™ì  í• ë‹¹ì„ í•˜ëŠ” ê²ƒ
- ê°€ê¸‰ì  ì•ˆì“°ëŠ”ê²Œ ì¢‹ìŒ virtual í•¨ìˆ˜ë¡œ í•´ê²°í•˜ëŠ”ê²ƒì´ ì¢‹ìŒ
  - ì½”ë“œ ì½ê¸° í˜ë“¤ê³  ë””ë²„ê¹…í•˜ê¸° í˜ë“¬

```cpp
int main()
{
	Derived1 d1;
	Base * base = &d1;

    auto *base_to_d1 = dynamic_cast<Derived2*>(base);

    if (base_to_d1 != nullptr)
        cout << base_to_d1->m_name << endl;
    else
        cout << "Failed" << endl;

	return 0;
}
```
- `dynamic_cast` ëŠ” ìºìŠ¤íŒ…ì— ì‹¤íŒ¨í•˜ë©´ nullptrì„ ë„£ì–´ë²„ë¦¼
  - ë³´í†µ ifë¬¸ìœ¼ë¡œ ì²´í¬í•¨
- Derived1 ìœ¼ë¡œ ë°”ê¾¼ ì• ë¥¼ baseë¡œ ë°”ê¿¨ë‹¤ê°€ ê°•ì œë¡œ Derived2ë¡œ ë°”ê¿€ë ¤ê³ í•˜ë‹ˆê¹Œ ì•ˆë˜ëŠ” ê²ƒ
- ë™ì  ìºìŠ¤íŒ…ì€ ëŸ°íƒ€ì„ì—ì„œ ì¡ì„ìˆ˜ ìˆìŒ

___

**static_cast**

```cpp
int main()
{
	Derived1 d1;
	Base* base = &d1;

	auto* base_to_d1 = static_cast<Derived2*>(base);

	if (base_to_d1 != nullptr)
		base_to_d1->print();
	else
		cout << "Failed" << endl;

	return 0;
}
```
- static_castë„ ì‚¬ìš©í• ìˆ˜ ìˆìŒ
- ì›ë˜ëŠ” í˜•ë³€í™˜ì— ì‹¤íŒ¨í•˜ëŠ”ê²Œ ë§ì§€ë§Œ static_castëŠ” ë˜ëŠ”ë°ë¡œ ë°€ì–´ ë¶™ì„

### **ğŸŒ± 12.11 ìœ ë„í´ë˜ìŠ¤ì—ì„œ ì¶œë ¥ ì—°ì‚°ì ì‚¬ìš©í•˜ê¸°**

- ì¶œë ¥ì—°ì‚°ìëŠ” ì˜¤ë²„ë¼ì´ë”©ì„ í• ìˆ˜ì—†ìŒ 

```cpp
#include <iostream>
using namespace std;

class Base
{
private:
	int m_base;
public:
	Base(const int& input = 0)
		:m_base(input) {}
	friend ostream& operator << (ostream& out, const Base& base)
	{
		return base.print(out);
	}
	virtual ostream& print(ostream& out) const
	{
		out << "Base";
		return out;
	}
};

class Derived : public Base
{
public:
	virtual ostream& print(ostream& out) const override
	{
		out << "Derived";
		return out;
	}
};
int main()
{
    Base b;
    std::cout << b << '\n';

    Derived d;
    std::cout << d << '\n';

    Base & bref = d;
    std::cout << bref << '\n';
}
```

- ë©¤ë²„ë¡œ ë§Œë“¤ìˆ˜ ì—†ëŠ” í•¨ìˆ˜ë¥¼ ì˜¤ë²„ë¼ì´ë”©í•œê²ƒ ì²˜ëŸ¼ ì‚¬ìš©í•˜ê¸°ìœ„í•´ì„œ ê¸°ëŠ¥ì„ ìœ„ì„ë°›ì€ ì¼ë°˜ í•¨ìˆ˜ë¥¼ êµ¬í˜„í•´ì„œ virtualë¡œ ë§Œë“¤ì–´ ìì‹í´ë˜ìŠ¤ì—ì„œ ì˜¤ë²„ë¡œë”© í•œê²ƒ
- virtualì„ ì—¬ëŸ¬ê°œë¥¼ ì¡°í•©í•˜ëŠ” ë°©ì‹ë„ ìˆìŒ

# ğŸ“Œì°¸ì¡°ë§í¬
ì¸í”„ëŸ° **ë”°ë¼í•˜ë©´ì„œ ë°°ìš°ëŠ” C++** - [https://www.inflearn.com/course/following-c-plus](https://www.inflearn.com/course/following-c-plus)

**ê³µë¶€í•˜ëŠ” ì‹ë¹µë§˜ ğŸ‘±â€â™€ï¸ ë‹˜ì˜ ë¸”ë¡œê·¸** - [https://ansohxxn.github.io/](https://ansohxxn.github.io/)